# λ„¤νΈμ›ν¬ λ³΄μ• κΈ°μ΄ (TLS)

- [Backgrounds](#backgrounds)

  - [Link encryption & End - to - End encryption](#link-encryption--end---to---end-encryption)

  - [ν‚¤ λ™μ(Key Agreement) ν”„λ΅ν† μ½ (or Key exchange)](#ν‚¤-λ™μkey-agreement-ν”„λ΅ν† μ½-or-key-exchange)

- [SSL / TLS ν”„λ΅ν† μ½](#ssl--tls-ν”„λ΅ν† μ½)

  - [SSL / TLS ν”„λ΅ν† μ½ κµ¬μ΅°](#ssl--tls-ν”„λ΅ν† μ½-κµ¬μ΅°)

    - [Handshake Protocol](#handshake-protocol)

    - [ChangeCipherSpec Protocol](#changecipherspec-protocol)

    - [Alert Protocol](#alert-protocol)

    - [Record Protocol](#record-protocol)

  - [SSL / TLS ν¨ν‚· κµ¬μ΅°](#ssl--tls-ν¨ν‚·-κµ¬μ΅°)

---

## Backgrounds

<img width="558" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 1 29 27" src="https://github.com/jjaehwi/2023_Network/assets/87372606/2367ddb4-88d9-4541-9cc9-5df219dd160b">

- λ„¤νΈμ›ν¬ κ³„μΈµμ€ OSI 7 κ³„μΈµμΌλ΅ κµ¬μ„±λλ‹¤.

<img width="579" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 1 29 44" src="https://github.com/jjaehwi/2023_Network/assets/87372606/d3750a39-b1a2-47ad-b1d3-b3bf66045784">

<img width="549" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 1 30 47" src="https://github.com/jjaehwi/2023_Network/assets/87372606/f1220c1a-79fc-487c-a27b-6f0b5a35b6d2">

- κ° κ³„μΈµμ„ λ‚΄λ ¤κ° λ•λ§λ‹¤ ν—¤λ”κ°€ λ¶™μ–΄μ„ ν¨ν‚·μ΄ λ§λ“¤μ–΄μ§„λ‹¤.

- `TCP/IP` is a **client-server model**, i.e. when the client requests for service
  it is provided by the server. Whereas, `OSI` is a **conceptual model**.

- `TCP/IP` is a **standard protocol** used for every network including the Internet, whereas, `OSI` is not a protocol but **a reference model** used for understanding and designing the system architecture.

- `TCP/IP` is a **four layered model**, whereas, `OSI` has **seven layers**.

### Link encryption & End - to - End encryption

<img width="603" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 11 05" src="https://github.com/jjaehwi/2023_Network/assets/87372606/db3c45ce-17e5-4279-bf27-122acf0728c2">

- `Link encryption`

  - μ•”νΈν™”κ°€ λ§ν¬ λ‹¨μ„λ΅ μ΄λ¤„μ§

  - μ•”νΈν™”κ°€ λ¨λ“  λ§ν¬μ—μ„ λ…λ¦½μ μΌλ΅ μν–‰λ¨

  - λ¨λ“  λ§ν¬κ°„μ μ‚¬μ „μ— κ³µμ λ ν‚¤κ°€ ν•„μ”ν•¨

  - (ex) λ¨λ°”μΌ κΈ°κΈ°λ“¤μ΄ λ¬΄μ„  AP μ— p/w λ¥Ό ν†µν•΄ μ ‘κ·Όν•κ³  ν†µμ‹ ν•¨ -> p/w λ¥Ό κΈ°λ°μΌλ΅ μ•”νΈν™”ν• κ²ƒ (λ¬΄μ„  λ§ν¬κ°„ μ•”νΈν™”)

- `Endβ€toβ€End encryption`

  - μ•”νΈν™”κ°€ μ‹μ‘μ  (source) κ³Ό λ„μ°©μ  (Destination) μ—μ„ μν–‰λ¨

  - μ¤‘κ°„ λ…Έλ“λ“¤μ€ λ°μ΄ν„°λ¥Ό λ³Ό μ μ—†λ‹¤.

  - (ex) μΉ΄μΉ΄μ¤ λΉ„λ°€ μ±„ν… (μ¤‘κ°„μ λ…Έλ“λ“¤μ€ λ°μ΄ν„°λ¥Ό λ³΄μ§€ λ»ν•κ³  end - to - end λ΅ ν†µμ‹ )

- **_end - to - end encryption μ„ ν•κ² λλ©΄ IP μ£Όμ† κ°™μ€ κ²ƒ traffic flow λ“¤μ€ λ³΄νΈλμ§€ μ•λ”λ‹¤._**

  - μ»¨ν…μΈ λ” μ•”νΈν™”λμ–΄ λ³΄μ΄μ§€ μ•μ§€λ§ μ™”λ‹¤κ°”λ‹¤ν•λ” traffic μ€ μ• μ μλ‹¤.

  - When using Endβ€toβ€End encryption must leave headers (e.g., IP address) in clear

  - ν—¤λ”μ— ν¬ν•¨λ μ •λ³΄ (i.e., IP μ£Όμ†)λ¥Ό ν†µν•΄ ν¨ν‚· λΌμ°ν…μ„ ν•κ² λ¨

  - **But, traffic flows are not protected**

    - λ§μ•½ Aμ™€ Bκ°€ End-to-End μ•”νΈν™”λ¥Ό ν†µν•΄ ν†µμ‹ μ„ ν•κ³  μλ” μƒν™©μ΄λΌλ©΄, νΈλν”½ λ¶„μ„μ„ ν†µν•΄ Aμ™€ Bμ™€ ν†µμ‹ μ„ ν•κ³  μλ‹¤λ” κ²ƒμ€ μ•κ² λ¨ (ν†µμ‹  μ»¨ν…μΈ λ” μ•”νΈν™”λ¥Ό ν†µν•΄ λ³΄νΈ)

- Link encryption κ³Ό End - to - End encryption μ„ κ°™μ΄ μ‚¬μ©ν•λ©΄ μ»¨ν…μΈ λ„ λ³΄νΈλκ³  traffic flow λ„ μ–΄λμ •λ„ λ³΄νΈν•  μ μλ‹¤. (ex. VPN)

  - `Endβ€toβ€End` **protects data contents** over the entire path

  - `Link encryption` **protects traffic flows** from monitoring

- λ©”μ‹μ§€ μΈμ¦μ„ μ„ν•΄ λ„¤νΈμ›ν¬ ν¨ν‚·μ— λ©”μ‹μ§€ μΈμ¦ μ•κ³ λ¦¬μ¦λ„ μ μ©λμ–΄μ•Ό ν•λ‹¤. (ex. MAC)

---

### ν‚¤ λ™μ(Key Agreement) ν”„λ΅ν† μ½ (or Key exchange)

<img width="544" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 19 01" src="https://github.com/jjaehwi/2023_Network/assets/87372606/c5d8ee7f-e581-4870-85dc-bb42ad23cf50">

- ν‚¤ λ™μ or ν‚¤ κµν™ ν”„λ΅ν† μ½μ΄ ν•„μ”ν• μ΄μ  : μΈν„°λ„·μ΄ λ°μ „ν•λ©΄μ„ κ³µκ²©μλ“¤μ΄ λ§μ΄ μƒκ²¨λ‚¬κ³  μ μ € μ‚¬μ΄ μ•μ „ν•κ² ν†µμ‹ ν•κΈ° μ„ν•΄ λ³΄μ•μ΄ κΌ­ ν•„μ”ν•κ³ , λ³΄μ•μ ν•µμ‹¬μ€ key μ„Έν…μ„ μ–΄λ–»κ² ν•λλƒμ— κ΄€ν• κ²ƒμ΄λ‹¤.

  - A μ™€ B κ°€ λ§λ‚μ„ ν‚¤λ¥Ό κµν™ν•λ” κ²ƒμ€ λ„λ¬΄ λΉ„ν¨μ¨μ μ΄κΈ° λ•λ¬Έμ— μ‹ λΆ°λμ§€ μ•λ” μΈν„°λ„· μ±„λ„μ„ ν†µν•΄ ν‚¤λ¥Ό κµν™ν•λ” λ°©λ²•λ“¤μ΄ μ„¤κ³„λμ—κ³  μ•μ „ν•λ‹¤λ” κ²ƒμ΄ μ¦λ…λμ—λ‹¤.

  - κ·Έλ¦Όμ—μ„ **A μ™€ B λ” μ„λ΅ λλ¤ν• κ°’ (nonce) λ¥Ό μ£Όκ³ λ°›μΌλ©΄μ„ κ°’μ— λ€ν•΄ guarantee λ¥Ό ν•κ³  ν‚¤λ¥Ό κµν™**ν•λ‹¤.

  - λλ¤ν• κ°’μ„ κΈ°λ°μΌλ΅ νΉμ • ν‚¤ μ λ„ ν•¨μ (hash) λ¥Ό ν†µκ³Όμ‹μΌ ν‚¤λ¥Ό μƒμ„± (κ° A, B μ—μ„ μƒμ„±λλ” ν‚¤λ” λ™μΌν•¨)

<img width="622" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 23 10" src="https://github.com/jjaehwi/2023_Network/assets/87372606/d9fdb467-1af9-48af-a783-73e96ca968ce">

- `Diffie-Hellman ν‚¤ κµν™ ν”„λ΅ν† μ½`

  - μν•™μ  λ°°κ²½ : λ¨λ“λ¬ μ—°μ‚°μ„ ν†µν• **DLP λ¬Έμ **

  - The problem of finding π‘¥ such that `π‘^π‘¥ β‰΅ π‘ (π‘π‘π‘‘ π‘)` is called the discrete logarithm problem. (DLP)

  - μ«μκ°€ μ—„μ²­ μ»¤μ§€λ©΄ κ³µκ²©μκ°€ μ μ¶”ν•  μ μ—†λ‹¤.

<img width="491" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 28 58" src="https://github.com/jjaehwi/2023_Network/assets/87372606/a2e6bb9d-1bc1-49a1-b551-4c6c3b208950">

<img width="569" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 31 56" src="https://github.com/jjaehwi/2023_Network/assets/87372606/8ad2af8a-5659-44c1-aec1-48e476c8236d">

- `STS (Station - To - Station) ν”„λ΅ν† μ½`

  - μ¤‘κ°„μ κ³µκ²©μ΄ μμ„ μλ„ μμΌλ―€λ΅ ν‚¤ κµν™μ„ ν•  λ•, PKI μ„λ… (μΈμ¦μ„ κµν™) μ„ κ²€μ¦ ν•΄μ•Όν•λ‹¤.

---

## SSL / TLS ν”„λ΅ν† μ½

- `SSL/TLS ν”„λ΅ν† μ½`μ€ **_ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ ν†µμ‹ μ— `λ©”μ‹μ§€ μΈμ¦`, `κΈ°λ°€μ„±μ„ μ κ³µ`ν•κ³  `κ°€μ©μ„±λ„ μ κ³µ`ν•λ” κΈ°μ μ΄λ‹¤._**

<img width="523" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 35 45" src="https://github.com/jjaehwi/2023_Network/assets/87372606/880cdc26-07dd-4397-9458-49d6c5b6856b">

- **μ•”νΈν™” λμ§€ μ•μ€ ν¨ν‚· (e.g., HTTP) μ€ SSL ν¨ν‚·μΌλ΅ μΈμ½”λ”© λλ©΄μ„ μ•”νΈν™”κ°€ μ§„ν–‰**λλ‹¤. **(e.g., HTTPS)**

  - **Transport layer λ¥Ό λ³΄νΈ**ν•κΈ° μ„ν•΄ μ΅΄μ¬.

- μ§€κΈκΉμ§€ λ§λ“¤μ—λ ν¨ν‚·μ€ λ³΄μ•μ μΌλ΅ μ•μ „ν•μ§€ μ•μ€ ν¨ν‚·μ΄μ—λ‹¤. SSL λ΅ λ²„μ „μ—…μ΄ λλ©΄μ„ λ°μ „ν–λ”λ°, λ­”κ°€ μ·¨μ•½μ μ΄ κ³„μ† μμ–΄μ„ μ•„μ μƒλ΅μ΄ κΈ°μ μ„ λ§λ“¤μ–΄μ„ μ™„μ „ λ‹¤λ¦„μ„ μΈμ‹. (TLS κ°€ μµκ·Ό λ²„μ „μΈ κ²ƒ)

<img width="557" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 38 46" src="https://github.com/jjaehwi/2023_Network/assets/87372606/7f8fa474-4240-4140-ab41-f3d113f0dca8">

<img width="509" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 39 11" src="https://github.com/jjaehwi/2023_Network/assets/87372606/d5f211ed-4d1b-4719-a8a3-382f1d861afa">

- κΈ°μ΅΄ http μ—μ„λ” λ°μ΄ν„°κ°€ μ•”νΈν™”λμ§€ μ•μ•„μ„ λ‹¤ λ³΄μ€λ‹¤.

- https μ—μ„λ” **μ„λ²„ μΈμ¦μ„μ™€, λΈλΌμ°μ € μΈμ¦μ„λ¥Ό ν†µν•΄ ν‚¤ κµν™μ„ ν•΄μ„ μ•”νΈν™”**λ¥Ό ν•λ‹¤. (TLS λ³΄μ• ν†µμ‹ )

---

### SSL / TLS ν”„λ΅ν† μ½ κµ¬μ΅°

<img width="574" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 2 40 53" src="https://github.com/jjaehwi/2023_Network/assets/87372606/75d2286d-c853-4799-bab2-88df6e23391c">

- App layer μ™€ Transport layer μ‚¬μ΄μ— μ΅΄μ¬ν•λ©° TLS μ—λ” μ΄ 4 κ°€μ§€μ ν”„λ΅ν† μ½μ΄ μ„Έλ¶€μ μΌλ΅ κµ¬μ„±λμ–΄μλ‹¤.

  1. `Handshake Protocol`

     - μ„λ΅ λ­ μ“Έμ§€ ν™•μΈν•κ³  λ§μ¶”λ” κ²ƒ

  2. `ChangeCipherSpec Protocol`

     - μ“°κΈ°λ΅ ν–λ μ•κ³ λ¦¬μ¦κ³Ό μ•κ³ λ¦¬μ¦μ— ν•„μ”ν• key κ°’μ΄ μ λ€λ΅ μ„Έν…λμ—λ”μ§€ confirm ν•λ” κ³Όμ •

  3. `Record Protocol`

     - μ•”νΈν™” + μΈμ¦ μ΄ μ μ©λ ν†µμ‹ 

  4. `Alert Protocol`

     - 1, 2, 3 μ κ³Όμ •μ—μ„ μ—λ¬κ°€ λ°μƒν–μ„ λ•μ μ—λ¬λ¥Ό μ •μν•κ³  μ—λ¬κ°€ λ°μƒν–μμ„ μ•λ¦¬λ” ν”„λ΅ν† μ½

---

### Handshake Protocol

<img width="589" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 05 23" src="https://github.com/jjaehwi/2023_Network/assets/87372606/b6c583a5-fa71-403d-8434-cadb8d99da48">

- μ–΄λ–¤ μ•”νΈ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•  κ²ƒμΈμ§€, μ‚¬μ©ν•λ” μ•”νΈ μ•κ³ λ¦¬μ¦μ— μ‚¬μ©λλ” μΈμ¦ ν‚¤λ¥Ό μ–΄λ–»κ² λ§λ“¤ κ²ƒμΈμ§€ negotiation ν•λ” λ‹¨κ³„ (The negotiation of the cipher suite and the generation of cryptographic secrets)

  1. ν΄λΌμ΄μ–ΈνΈκ°€ ClientHello λ¥Ό μ„λ²„μ—κ² λ³΄λ‚΄κ³  μ„λ²„λ” ServerHello λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ³΄λ‚Έλ‹¤.

  2. μ„λ²„μ TLS μΈμ¦μ„λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ³΄λ‚΄κ³ , μ„λ²„κ°€ ν‚¤λ¥Ό κµν™ν•κ³  μ‹¶λ‹¤κ³  ν‚¤ κµν™ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ³ , μΈμ¦μ„κ°€ μμΌλ©΄ λ‹¬λΌκ³  μ”μ²­μ„ λ³΄λ‚΄λ©΄μ„ ServerHello λ¥Ό λλ‚Έλ‹¤.

  3. ν΄λΌμ΄μ–ΈνΈλ„ μμ‹ μ μΈμ¦μ„λ¥Ό λ³΄λ‚΄κ³ , ν‚¤ κµν™ λ©”μ‹μ§€λ¥Ό λ³΄λ‚΄κ³ , μΈμ¦μ— λ€ν• Verify κ²°κ³Όλ¥Ό λ³΄λ‚Έλ‹¤.

  4. ChangeCipherSpec μ„ ν†µν•΄ μ‚¬μ©ν•  μ μλ” μ•κ³ λ¦¬μ¦μ΄ λ­”μ§€ μ–΄λ–¤ κ²ƒμ„ μ„ νƒν•  κ²ƒμΈμ§€ confirm.

  - ν‚¤ κµν™μ— μ“°μ΄λ” ν”„λ΅ν† μ½μ΄ Diffie-Hellman ν‚¤ κµν™ ν”„λ΅ν† μ½ μ΄λ‹¤.

---

<img width="589" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 06 59" src="https://github.com/jjaehwi/2023_Network/assets/87372606/913a65fa-f0f9-4d35-8d73-975d85f556d1">

- Phase I μΆ…λ£ ν›„, ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ•„λ μ •λ³΄λ¥Ό κµν™ν•κ² λ¨

  - TLS λ²„μ „, ν‚¤ κµν™ μ•κ³ λ¦¬μ¦, μΈμ¦ μ•κ³ λ¦¬μ¦, μ•”νΈν™” μ•κ³ λ¦¬μ¦, μ••μ¶• μ•κ³ λ¦¬μ¦, λλ¤ν• κ°’

  - **μ„λ΅ μ§€μ›κ°€λ¥ν• μ•κ³ λ¦¬μ¦ λ¦¬μ¤νΈλ¥Ό κ³µμ **ν•λ” κ²ƒ

  - μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ— λ§μ¶°μ£Όλ”λ°, μ„λ²„μ μµμ†λ³΄μ•μ”κµ¬μ‚¬ν•­μ„ λ§μ΅±ν•λ” μ•κ³ λ¦¬μ¦μ΄ ν΄λΌμ΄μ–ΈνΈμ— μ΅΄μ¬ν•λ©΄ μ„ νƒ (λ³΄ν†µ μ„λ²„κ°€ powerful)

---

<img width="589" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 07 49" src="https://github.com/jjaehwi/2023_Network/assets/87372606/d09fa69d-b968-4762-ba2c-31c7eabf9fec">

<img width="420" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 10 11" src="https://github.com/jjaehwi/2023_Network/assets/87372606/3c97a231-0170-4646-b45a-2405a7ab70bc">

- μ„λ²„λ” **μΈμ¦μ„μ™€ ν‚¤ κµν™ λ©”μ‹μ§€**λ¥Ό μ „μ†΅ ν•λ©°, ν•„μ”ν•  κ²½μ° **ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° μΈμ¦μ„ μ”μ²­ λ©”μ‹μ§€λ¥Ό μ „μ†΅ν•¨**

  - After Phase II, **ν΄λΌμ΄μ–ΈνΈλ” μ „μ†΅λ°›μ€ μΈμ¦μ„λ¥Ό ν†µν•΄ μ„λ²„λ¥Ό μΈμ¦**ν•κ² λκ³ , `ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ κ³µκ°ν‚¤λ¥Ό μ•κ² λ¨`

- μ„λ²„κ°€ ν΄λΌμ΄μ–ΈνΈμ— λ°μ΄ν„°λ¥Ό λ³΄λ‚Ό λ•, μ„λ²„κ°€ s λΌλ” λλ¤ν• κ°’μ„ λ§λ“  ν›„ μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄μ— κ³µμ λ g μ™€ p λ¥Ό λ°”νƒ•μΌλ΅ g^s mod p λ¥Ό ν•΄μ„ g^s λ΅ μ„λ²„μ κ°μΈν‚¤μ— μ„λ…μ„ ν•λ‹¤.

  - μ„λ²„λ” μ΄ μ„λ…κ°’κ³Ό μ„λ…μ„ μΈμ¦ν•  μ μλ” μΈμ¦μ„λ¥Ό ν΄λΌμ΄μ–ΈνΈμ— λ³΄λ‚Έλ‹¤.

<img width="541" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 12 05" src="https://github.com/jjaehwi/2023_Network/assets/87372606/b38003c7-caa7-4a74-964c-963517af94e4">

---

<img width="572" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 13 14" src="https://github.com/jjaehwi/2023_Network/assets/87372606/65688a30-5d22-4681-8abe-6196ff7967f4">

<img width="487" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 13 41" src="https://github.com/jjaehwi/2023_Network/assets/87372606/deb520d4-f092-4e0f-9847-979a8ba3095b">

- **_μ„λ²„λ΅λ¶€ν„° Certificate Request λ©”μ‹μ§€λ¥Ό μμ‹ ν•μ€μ„ κ²½μ°, ν΄λΌμ΄μ–ΈνΈμ μΈμ¦μ„λ¥Ό λ³΄λ‚΄μ¤_**

  - After Phase III, **μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈλ¥Ό μΈμ¦ν•  μ μκ² λκ³ **, **μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈλ” pre - master secret(PM)λ¥Ό κ³µμ ν•κ² λ¨**

- ν΄λΌμ΄μ–ΈνΈλ„ λλ¤ν• κ°’ c λ¥Ό λ§λ“¤κ³ , g^c mod p μ— μ„λ…μ„ ν•λ‹¤.

  - ν΄λΌμ΄μ–ΈνΈλ” μ΄ ν‚¤ κµν™ νλΌλ―Έν„°μ— λ€ν• μ„λ…κ°’κ³Ό, μΈμ¦μ„λ¥Ό μ„λ²„μ— λ³΄λ‚Έλ‹¤.

  - κ·Έλ¬λ©΄ **μ„λ΅ κ³µμ ν•λ” ν‚¤κ°€ μƒκΈ°κ² λλ‹¤. (g^cs)** = `pre - master secret (PM)`

<img width="556" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 16 24" src="https://github.com/jjaehwi/2023_Network/assets/87372606/6625fd4b-984b-4286-9d05-c6d59a6dd019">

- phase II μ™€ phase III μ—μ„ λ™μΌν• λ°©λ²•μ„ μ‚¬μ©ν•΄μ•Όν•λ‹¤.

---

<img width="556" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 17 41" src="https://github.com/jjaehwi/2023_Network/assets/87372606/9172711d-70e3-415f-a51a-b0fa5732241b">

- ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ•”νΈ μ•κ³ λ¦¬μ¦κ³Ό μ• νλΌλ―Έν„°λ¥Ό λ³€κ²½ν•λ” λ©”μ‹μ§€λ¥Ό μ£Όκ³  λ°›κ³ , Handshake ν”„λ΅ν† μ½ μΆ…λ£ λ©”μ‹μ§€ λ¥Ό μ£Όκ³  λ°›μμΌλ΅μ¨ Handshake ν”„λ΅ν† μ½μ„ μΆ…λ£ν•λ‹¤.

  - After Phase IV, **the client and server are ready to exchange data.**

- finish κ³Όμ •μ΄ λλ‚λ©΄ μ•μΌλ΅ μ‚¬μ©ν•  μ•κ³ λ¦¬μ¦κ³Ό μ•κ³ λ¦¬μ¦μ— μ‚¬μ©λ  key λ“¤μ΄ λ‹¤ μ„Έν…λ μƒνƒ.

---

<img width="527" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 20 04" src="https://github.com/jjaehwi/2023_Network/assets/87372606/2c62fe8a-abaf-446b-9e06-b03f0910b1bb">

- DLP ν‚¤ κµν™ μ•κ³ λ¦¬μ¦μ„ ν†µν•΄ PM μ„ μ–»κ³  ν‚¤ μƒμ„± ν•¨μ (hash) λ¥Ό ν†µν•΄ μ›ν•λ” μ¶©λ¶„ν• κΈΈμ΄μ output κ°’μ„ μ–»κ³  μμ„λ€λ΅ ν‚¤μ μ—­ν• μ„ λ§¤κΈ΄λ‹¤.

---

### ChangeCipherSpec Protocol

<img width="632" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 22 29" src="https://github.com/jjaehwi/2023_Network/assets/87372606/2cf9f276-8c60-4570-aef5-0dba8a846773">

- Handshake Protocol μ΄ λλ‚λ©΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„λ” μ•”νΈν™” ν†µμ‹ μ„ ν•  μ¤€λΉ„κ°€ λλ‚ κ²ƒμ΄λ‹¤.

  - μ–΄λ–¤ μ•”νΈν™” μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν• μ§€, μ–΄λ–¤ μΈμ¦ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν• μ§€, μ•”νΈν™” μ•κ³ λ¦¬μ¦μ— μ‚¬μ©λλ” key, μΈμ¦μ— μ‚¬μ©λλ” key, initial κ°’μ΄ λ­”μ§€ μ„Έν…μ΄ λμ–΄μλ” μƒνƒ

        - μ•”νΈ μ•κ³ λ¦¬μ¦

        - MAC μ•κ³ λ¦¬μ¦

        - μ•”νΈν™” ν‚¤

        - MAC ν‚¤

        - μ΄κΈ°λ²΅ν„° IV

  - μ΄ κ°’λ“¤μ€ pending μƒνƒμ—μ„ active ν• μƒνƒλ΅ λ§λ“¤μ–΄μ¤€λ‹¤.

- **ChangeCipherSpec μ„ λ³΄λ‚Έλ‹¤λ” κ²ƒ = writing κ΄€λ ¨**

- **ChangeCipherSpec μ„ λ°›λ” κ²ƒ = Read κ΄€λ ¨**

  - ν΄λΌμ΄μ–ΈνΈκ°€ ChangeCipherSpec λ¥Ό λ³΄λ‚΄λ©΄ pending μƒνƒμ— μλ Write κ°’μ΄ active μƒνƒλ΅ μ®κ²¨μ§„λ‹¤.

  - ChangeCipherSpec λ¥Ό λ°›μ€ μ„λ²„μ—μ„λ” Read μƒνƒκ°€ enable λμ–΄ pending μ— μλ Read κ°’λ“¤μ΄ active μƒνƒλ΅ μ®κ²¨μ§„λ‹¤.

  - λ°λ€λ„ λ§μ°¬κ°€μ§€..

---

### Alert Protocol

<img width="597" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 28 51" src="https://github.com/jjaehwi/2023_Network/assets/87372606/a006008d-e7d7-41b8-9382-453d08ca4287">

- **SSL / TLS μ‹μ¤ν…μ΄ λΉ„μ •μƒμ μΌλ΅ λ™μ‘ν•μ€μ„ λ• `μ—λ¬μ²λ¦¬`λ¥Ό ν•κΈ° μ„ν•μ—¬ μ—λ¬λ‚ κ²½κ³  λ©”μ‹μ§€λ¥Ό `Alert ν”„λ΅ν† μ½`μ—μ„ μ •μ**

  - μ—λ¬ κ°’λ“¤μ΄ μ •μλμ–΄ μμ

---

### Record Protocol

<img width="544" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 32 29" src="https://github.com/jjaehwi/2023_Network/assets/87372606/031a4098-2fc4-4786-bc5c-307db1d26e9d">

- μ•”νΈν™” ν†µμ‹ μ„ ν•λ©΄ λ¨. -> μ•”νΈν™”λ‘ μΈμ¦ λ°μ΄ν„°λ¥Ό λ³΄λ‚΄λ” κ²ƒ

- App μ—μ„ λ°μ΄ν„°κ°€ λ§λ“¤μ–΄μ§€λ©΄ `μΌκ°μ§€κ³ ` `μ••μ¶•`λλ‹¤.

- μ••μ¶•λ λ°μ΄ν„°μ— **MAC μ„ ν†µν•΄ μΈμ¦κ°’μ„ μ¶”κ°€**ν•λ‹¤.

  - pending μƒνƒμ—μ„ active μƒνƒκ°€ λ **MAC ν‚¤λ¥Ό κ°™μ΄ λ„£μ–΄μ¤**. (**_λ°μ΄ν„°μ™€ ν‚¤κ°€ λ“¤μ–΄κ°€μ„ μΈμ¦κ°’μ΄ λλ” κ²ƒ_**)

- **μ••μ¶•λ λ°μ΄ν„°μ™€ μΈμ¦κ°’μ΄ λ¶™μ€ λ°μ΄ν„°λ¥Ό μ „μ²΄μ μΌλ΅ μ•”νΈν™”**ν•λ‹¤.

- μ•”νΈν™”λ λ°μ΄ν„°κ°€ λκ³  `SSL / TLS payload` κ°€ λλ‹¤. (**_μ•”νΈν™”μ™€ μΈμ¦μ΄ μ μ©λ ν¨ν‚·μ΄ λ§λ“¤μ–΄μ§„ κ²ƒ_**)

---

### SSL / TLS ν¨ν‚· κµ¬μ΅°

- `μ•”νΈν™” x`

<img width="420" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 35 19" src="https://github.com/jjaehwi/2023_Network/assets/87372606/c9ae385e-dc8f-4090-8bd1-93ce311e3cff">

- `μ•”νΈν™” o`

<img width="356" alt="α„‰α…³α„α…³α„…α…µα†«α„‰α…£α†Ί 2023-06-10 α„‹α…©α„α…¥α†« 3 34 16" src="https://github.com/jjaehwi/2023_Network/assets/87372606/25f31261-a005-45a3-9aad-8d7fa965221a">

- **TCP Data μλ¦¬μ— Encrypted data (μ•”νΈν™”λ λ°μ΄ν„°), MAC (μΈμ¦κ°’) μ΄ λ“¤μ–΄κ°„λ‹¤.**
